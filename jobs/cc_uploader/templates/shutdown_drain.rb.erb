#!/var/vcap/packages/ruby-3.2/bin/ruby --disable-all

$LOAD_PATH.unshift('/var/vcap/packages/cloud_controller_ng/cloud_controller_ng/app')
$LOAD_PATH.unshift('/var/vcap/packages/cloud_controller_ng/cloud_controller_ng/lib')

require 'cloud_controller/drain'

@threads = []
@grace_period = <%= p("cc.jobs.cc_uploader.grace_period_seconds") %>
@drain = VCAP::CloudController::Drain.new('/var/vcap/sys/log/cc_uploader')


@drain.shutdown_delayed_worker("/var/vcap/sys/run/bpm/cc_uploader/cc_uploader_#{i}.pid", @grace_period.to_i)
